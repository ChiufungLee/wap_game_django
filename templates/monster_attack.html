{% extends 'base.html' %}
{% block title %} è¿›å…¥æ¸¸æˆ {% endblock %}
{% load static %}

{% block content %}

<div id="content"></div>
{% if op_action == 'attack_monster' %}

{% if attack_result %}
    {% if attack_result.player_died %}
        <div class="defeat">
            <h3>ğŸ’€ ä½ è¢« {{ npc.name }} å‡»è´¥äº†ï¼ ğŸ’€</h3>
            <p>ä½ å·²è¢«ä¼ é€åˆ°å®‰å…¨åŒºï¼Œå¹¶æ¢å¤äº†éƒ¨åˆ†ç”Ÿå‘½å€¼ã€‚</p>
            <p>å½“å‰ç”Ÿå‘½å€¼: {{ attack_result.player_current_hp }}/{{ player.max_hp }}</p>
            
            <div class="actions">
            <a href="/wap/?cmd={{ wap_encrypted_param }}" class="btn">è¿”å›å®‰å…¨åŒº</a>
            </div>
        </div>

    {% else %}
        {% if attack_result.skill_used %}
            <p>ä½ ä½¿ç”¨äº† {{ attack_result.skill_used }} æŠ€èƒ½ï¼</p>
        {% else %}
            <p>ä½ å‘åŠ¨äº†æ™®é€šæ”»å‡»ï¼</p>
        {% endif %}

        <p>ä½ å¯¹æ€ªç‰©é€ æˆäº† <span class="damage">{{ attack_result.player_damage }}</span> ç‚¹ä¼¤å®³ï¼</p>
        <p>æ€ªç‰©å¯¹ä½ é€ æˆäº† <span class="damage">{{ attack_result.monster_damage }}</span> ç‚¹ä¼¤å®³ï¼</p>
    {% endif %}
{% endif %}


<p><a href="">æŸ¥çœ‹</a> <a href="">é€ƒè·‘(50é“œå¸)</a></p>
<p>ä½ ç”Ÿå‘½ï¼š{{player.current_hp}}/{{player.max_hp}} -{{ attack_result.monster_damage }}</p>
<p>ä½ æ”»å‡»ï¼š{{player.min_attack}}-{{player.max_attack}}</p>
<p>ä½ é˜²å¾¡ï¼š{{player.min_defense}}-{{player.max_defense}}</p>
<p>ä½ çŠ¶æ€ï¼šä¸­æ¯’</p>
<p>----------------------</p>
    {% if attack_result.remaining_hp > 0 %}
        <p>{{npc.name}}ç”Ÿå‘½ï¼š{{ attack_result.remaining_hp }}/{{ npc.hp }}  -{{ attack_result.player_damage }}</p>
        <p>{{npc.name}}çŠ¶æ€ï¼šè™šå¼±</p>
        <p> {% for skill in player_skills %} <a href="/wap/?cmd={{skill.cmd_params}}">{{skill.name}}</a>{% endfor %} </p>
    {% else %}
        {% if attack_result.killed %}
        <div class="victory">
            <p>æˆåŠŸå‡»æ€äº† {{ npc.name }}</p>
            
            {% if reward_info %}
            <p>è·å¾—ç»éªŒ: +{{ reward_info.exp }}</p>
            <p>è·å¾—é‡‘é’±: +{{ reward_info.gold }} é‡‘å¸</p>
            
                {% if reward_info.loot %}
                    <p>æ‰è½ç‰©å“:
                    {% for item in attack_result.reward_info.loot %}
                       {{ item.name }} x{{ item.quantity }} ã€
                    {% endfor %}
                    </p>
                {% else %}
                    <p>æ²¡æœ‰è·å¾—ç‰©å“</p>
                {% endif %}
            {% endif %}
        {% else %}
        <p> {% for skill in player_skills %} <a href="/wap/?cmd={{skill.cmd_params}}">{{skill.name}}</a>{% endfor %} </p>
        
        {% endif %}
    {% endif %}
<!-- <p><a href="">æ”»å‡»</a></p> -->
    
{% else %}
{% endif %}


</div>

<a href="#" onclick="goBack()">è¿”å›ä¸Šé¡µ</a><br>
<a href="/wap/?cmd={{ wap_encrypted_param }}">è¿”å›æ¸¸æˆ</a>


{% endblock %}
